# Development

## Git workflow
- The Git workflow *Gitflow* as described [here](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow) 
is applied for the development 

- push tags only: `git push origin --tags`

## Versioning

- [Semantic Versioning](https://semver.org/) is employed as versioning scheme for all modules.

- The version of the parent pom determines also the version of each sub module.
Version are increased simultaneously for all sub modules to indicate which dependencies
can be used together.
    - This version can be specified in `.mvn/maven.config`.

## Changelog

Changelogs are generated via the `changelog.sh` bash script. Also see [Deployment](#Deployment).
They belong also to the [Documentation](#Documentation).

## Module Separation

Each module represents a concrete subset of the framework's whole functionality.
Thus, it makes it easy to include a certain dependency in external projects for
specific needs, at the same time logically organizing the whole project.

<!--_v3: current-->
<!--_v5: cdo migrated model-->
<!--_v6: with extra BBigraph container object-->

# Documentation

- The documentation includes javadoc and a separate user manual (static website).
And also the changelog is part of it, see [Deployment](#Deployment).

- Docusaurus is used as a static site generator when building the user manual
It references also to the javadoc.
<!--- [MkDocs](https://www.mkdocs.org) is used as a static site generator, for building the user manual-->
<!--    - Must be installed on the machine:-->
<!--        - MkDocs, see [installation instructions](https://www.mkdocs.org/#installation)-->
<!--        - Theme: [Bootstrap](https://mkdocs.readthedocs.io/en/0.15.3/user-guide/styling-your-docs/#bootstrap-and-bootswatch-themes)-->
<!--<!--        - the theme is provided with the project and resides within `etc/doc/theme/mkdocs_windmill`-->-->
<!--    -->
<!--- The corresponding content of the documentation files are stored in `etc/doc/`-->
<!--- The layout is generated automatically-->

## Building the Documention

### Using Maven

- Available Maven goals from the root folder of the project:
```bash
$ ./mvnw clean install -Pdistribute
```
The generated user manual is available from `etc/doc/docusaurus/website/`.
The generated java documentation is available from `etc/doc/docusaurus/website/static/apidocs`.

### Using Docusaurus

```bash
cd ./etc/doc/docusaurus/website
npm start
```
<!--### Using Mkdocs directly-->

<!--- for testing purposes only-->

<!--You can also manually build the documentation using `mkdocs` directly:-->

<!--```bash-->
<!--# change into the 'etc/doc/' folder-->
<!--$ cd ./etc/doc/-->
<!--# start the build process: the html files are placed into the sub folder 'sites'-->
<!--$ mkdocs build-->
<!--# to publish them on a locally created web server (with auto-reload on changes)-->
<!--$ mkdocs serve-->
<!--```-->

# Deployment

The basic workflow looks like this.
Automated tests are executed on all branches.
The deployment process is executed after every merge into master or a 
version tag is created.

## Build configuration

- Goals to execute ... to run the build
- Goals to execute ... to deploy artifacts to [Bintray](https://bintray.com/)

git finish release
CI:
CI Friendly Versions: https://maven.apache.org/maven-ci-friendly.html
    - file-based version change with Maven: https://blog.soebes.de/blog/2016/08/08/maven-how-to-create-a-release/ 

mvn clean package install
mvn versions:set -DremoveSnapshot=true
mvn versions:set -DnextSnapshot=true
    mvn mod1 deploy
    mvn mod2 deploy
    mvn release:update-versions -DautoVersionSubmodules=true
    
    mvn --batch-mode release:update-versions -DautoVersionSubmodules=true -DdevelopmentVersion=1.2.0-SNAPSHOT


    mvn new snapshot version

git merge .... / go to dev / ...


Docs are pushed to GitHub for GitHub Pages
- second origin must be selected
- https://about.gitlab.com/blog/2017/11/02/automating-boring-git-operations-gitlab-ci/


## Changelog Generation

- are generated by a script and edited manually afterwards
- contains multiple sections: ADDED, CHANGED, REMOVED, BUGFIX
- git messages must be properly described using the section names above as tags
    - they will be extracted using the `git log` command
    
- Script
    - first parameter is the path to the maven.config file
    - second paramter is the path for the output file